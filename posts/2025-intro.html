<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pranshu's Blog - Building this website (old)</title>
        <link rel="stylesheet" href="../css/default.css" />
	<link rel="icon" href="../stuff/favicon.png">
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Pranshu's Blog</a>
		<button id="theme-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s ease;" id="themesvg"></svg></button>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
		<a align="right" href="../rss.xml">Feed</a>
            </nav>
        </header>
        <main role="main">
            <h1>Building this website (old)</h1>
            <article>
    <section class="header">
        Posted on April  5, 2025
        
    </section>
    <section class="info">
	
        tags: <a title="All pages tagged 'tech'." href="../tags/tech.html" rel="tag">tech</a>
        
    </section>
    <section>
        <h1 id="update">UPDATE!!!</h1>
<p><strong>November 2025:</strong>
Pretty much everything in this post is invalid as I use a completely
different system now.</p>
<h1 id="intro">Intro</h1>
<p>Right after spending about 2 weeks in making <em>genorg</em>, my supreme and
<em>functioning</em> (most of the time) static site generator<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, here are the
hows and whys.</p>
<h1 id="criteria">Criteria</h1>
<blockquote>
<p>My criteria compared to your career just isn't fair</p>
</blockquote>
<ul>
<li>The <del>markup</del> document type for the a blog article should be
<a href="https://orgmode.org/">Org</a>, or something as powerful(void).</li>
<li>The org to html function should be complete and work well. Currently
(and eternally), this is only done by the emacs org exporter itself.</li>
<li>Categories</li>
<li>Moving files around in the 'articles' directory should still
produce the same output blog. This means that the category info
would need to be in the article file itself.</li>
<li>A powerful and flexible templating system. This would be used for
example to export to the blog page.</li>
<li>Rss feeds.</li>
</ul>
<h2 id="comparasion-of-other-static-site-generators">Comparasion of other static site generators</h2>
<p>Before I decided to make my own thing, I tried to find other static site
generator that would meet this criteria. At the end, I was left with 2
valid options.</p>
<h3 id="hugojekyll">Hugo/jekyll</h3>
<p>The compromise here would be using the shabby hugo org export, or use
Hugo. However, this could pretty much be fixed by using
<a href="http://ox-hugo.scripter.co">ox-hugo</a>. Now I look back at it, this would
probably have been the better choice. oh well, I'm happy with I have
now. I reccomend this to to all readers who have a similar criteria.</p>
<p>Plus, using Hugo would remind me too much of the
<a href="https://en.wikipedia.org/wiki/Hugo_(film)">film</a> with the same name
which I vaguely remember watching, hence forcing me to rewatch and waste
2 hours.</p>
<h3 id="org-publish">Org publish</h3>
<p>I couldn't move files, plus I would have to hand maintain the category
pages. No thanks, I got better things to do (<em>gulp</em>).</p>
<h1 id="the-solution">The solution</h1>
<p>Writing about programming instead of just programming kinda sucks, bear
with me.</p>
<h2 id="genorg"><code class="verbatim">genorg</code></h2>
<p><code class="verbatim">genorg</code> is a perl script which generates the sites from a
input directory and a TOML configuration file. It scours and converts a
bunch of org files in the directory, and converts them to html (if
needed). Each of these files contain a <em>id</em> for internal use, and a
<em>category</em>.</p>
<pre><code>  Input                  Cache                Output
+-----------+       +---------------+       +-----------+
| Org files | ----&gt; | direct org    | ----&gt; | Modified  |
|           | ----&gt; | html export   | ----&gt; | html      |
+-----------+       +---------------+       +-----------+
                       |        |
                    +---------------+       +-----------+
                    | Neccasary info| ----&gt; | navigtion |
                    | eg title, date| ----&gt; | files     |
                    +---------------+       +-----------+</code></pre>
<p>Of course, any good static site generator needs a good templating
system. So since <em>genorg</em> used perl, I had a obvious choice ahead:
<a href="https://template-toolkit.org/">Template::Toolkit</a>. Since it used C code
with perl bindings, it was extremly fast. But still very powerful since
it has been around for a while.</p>
<p>A example info file generated by genorg to communicate with genserve:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;landing&quot;</span><span class="fu">:</span> <span class="st">&quot;templates/index.html.tt&quot;</span><span class="fu">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;blog_dir&quot;</span><span class="fu">:</span> <span class="st">&quot;/blog/&quot;</span><span class="fu">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;rss_dir&quot;</span><span class="fu">:</span> <span class="st">&quot;/rss/:cat&quot;</span><span class="fu">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;main_rss&quot;</span><span class="fu">:</span> <span class="st">&quot;templates/main.xml&quot;</span><span class="fu">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;blog_file&quot;</span><span class="fu">:</span> <span class="st">&quot;templates/blog.html.tt&quot;</span><span class="fu">,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;cpath&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;file&quot;</span><span class="fu">:</span> <span class="st">&quot;templates/1.html&quot;</span><span class="fu">,</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;rss&quot;</span><span class="fu">:</span> <span class="st">&quot;templates/1.html.xml&quot;</span><span class="fu">,</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;cat&quot;</span><span class="fu">:</span> <span class="st">&quot;tech&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;files&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;cat&quot;</span><span class="fu">:</span> <span class="st">&quot;tech&quot;</span><span class="fu">,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;art&quot;</span><span class="fu">:</span> <span class="st">&quot;introblog&quot;</span><span class="fu">,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;file&quot;</span><span class="fu">:</span> <span class="st">&quot;2025/intro.org.html&quot;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;cat&quot;</span><span class="fu">:</span> <span class="st">&quot;tech&quot;</span><span class="fu">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;file&quot;</span><span class="fu">:</span> <span class="st">&quot;2025/window.org.html&quot;</span><span class="fu">,</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;art&quot;</span><span class="fu">:</span> <span class="st">&quot;new_window_cmds&quot;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;main_rss_url&quot;</span><span class="fu">:</span> <span class="st">&quot;/rss&quot;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The navigation files are considered stuff like the category pages. To
keep the urls the same even when a org file is moved, the site needs to
dynamically resolve links into respsecite file paths.
<code>example.com/category/article-id</code> needs to find the file and serve it.</p>
<h3 id="why-perl">Why perl?</h3>
<blockquote>
<p>Lisp has all the visual appeal of oatmeal with fingernail clippings
mixed in.</p>
</blockquote>
<p>Larry Wall, as always, puts it very well. The other reasons are because
of <a href="https://en.wiktionary.org/wiki/TMTOWTDI#English">TIMTOWDI</a>, and
typed containers (in combination with a weakly typed language.).</p>
<h2 id="genserve"><code class="verbatim">genserve</code></h2>
<p>So now to serve the dynamicly serve the genorg output, all we have to do
is parse the json file and redirect files accordingly. Easy enough…
right?</p>
<p>Well, it would be if I was satisfied with http requests taking 0.0001
seconds to be proccesed by genorg instead of 0.00001 seconds.</p>
<p>So I initally decided to make the http server part in Go. This did not
go well, I didn't like the language, I didn't like the http server the
standard library provided. So in about one day, I wrote <strong>300+ lines</strong>
of zig code to make it work.</p>
<p>Although the process was tedious, the result was worth it, as any
visitors get to save approximately <span class="math inline">10 × 10<sup>−</sup>5 <em>s</em><em>e</em><em>c</em><em>o</em><em>n</em><em>d</em><em>s</em></span> for every
visit.</p>
<h1 id="code">Code</h1>
<p>My beautiful code can be found <a href="file:///g:/asset/genorg">here</a>. As for
the http server code, I won't share that. Simply cause it's crappy
code and it's going to be easy to find exploits in it. If you do decide
to use <code class="verbatim">genorg</code>, I suggest using a fastcgi script to serve
content based of the parsed <code class="verbatim">json</code>.</p>
<h1 id="what-now">What now?</h1>
<p>I'm very happy with the software used to generate the blog and
articles, but I still want to add some HTML and CSS and images in the
home page and category pages to make the site more vibrant (I've
recived feedback that this site reminds a viewer of a 'bee'). Maybe
later, I'll write about the non-technical aspect of blogs and why I
wanted to have one.</p>
<h1 id="footnotes">Footnotes</h1>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Well, technically <em>genorg</em> does also have a dynamic part to it.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
    </section>
</article>

        </main>

        <footer>
            2025 &copy Pranshu
        </footer>
	<script>
	 const themeToggle = document.getElementById('theme-toggle');
	 const themebutton = document.getElementById('themesvg');
	 const root = document.documentElement;
	 const moonsvg = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
	 const sunsvg = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
	 function applyTheme(theme) {
	     if (theme === 'dark') {
		 root.classList.add('dark-mode');
		 themebutton.innerHTML = moonsvg;
	     } else {
		 root.classList.remove('dark-mode');
		 themebutton.innerHTML = sunsvg;
	     }
	     localStorage.setItem('theme', theme);
	 }
	 document.addEventListener('DOMContentLoaded', () => {
	     const savedTheme = localStorage.getItem('theme');
	     if (savedTheme) {
		 applyTheme(savedTheme);
	     } else {
		 applyTheme('light');
	     }
	 });
	 themeToggle.addEventListener('click', () => {
	    if (root.classList.contains('dark-mode')) {
		 applyTheme('light');
	     } else {
		 applyTheme('dark');
	     }
	 });
	</script>
    </body>
</html>
 
